# 系统规则 {#concept_101079_zh .concept}

系统规则是从应用级别的**入口流量**进行控制，从应用的总体 Load、RT、QPS 和线程数四个维度监控应用数据，让系统尽可能跑在最大吞吐量的同时保证系统整体的稳定性。

## 背景信息 {#section_4fl_wkx_1q9 .section}

系统保护规则是应用整体维度的，而不是资源维度的，并且仅对入口流量生效。入口流量指的是进入应用的流量（EntryType.IN），例如 Web 服务或 Dubbo 服务端接收的请求，都属于入口流量。系统规则支持四种阈值类型：

-   Load（仅对 Linux/Unix-like 机器生效）：当系统 load1 超过阈值且系统当前的并发线程数超过系统容量时才会触发系统保护。
-   RT：当单台机器上所有入口流量的平均 RT 达到阈值即触发系统保护。
-   线程数：当单台机器上所有入口流量的并发线程数达到阈值即触发系统保护。
-   入口 QPS：当单台机器上所有入口流量的 QPS 达到阈值即触发系统保护。

对于一个应用来说，每种相同的系统保护规则最多只能存在一条，即一个应用最多配置四个系统保护规则。

## 新建系统规则 {#section_aj4_2n3_kgb .section}

1.  登录 [AHAS 控制台](https://ahas.console.aliyun.com/)。
2.  在 AHAS 控制台左上角，选择应用接入的**地域**。
3.  在控制台左侧导航栏中选择**流控降级** \> **应用流控降级**。
4.  在应用列表页面单击目标应用卡片。
5.  在左侧导航栏单击**系统规则**，在**系统规则**页面右上角单击**新建系统保护规则**。
6.  在**新建系统保护规则**对话框中，配置规则信息。

    ![新增系统保护规则](images/58039_zh-CN.png "新增系统保护规则")

    -   **Load** ：当系统的 Load1 超过阈值，且系统当前的并发线程数超过系统容量时才会触发系统保护。系统容量由系统的 maxQps \* minRt 计算得出。
    -   **RT**：当单台机器上所有入口流量的平均 RT 达到阈值即触发系统保护，单位是毫秒。
    -   **线程数**：当单台机器上所有入口流量的并发线程数达到阈值即触发系统保护。
    -   **入口 QPS**：当单台机器上所有入口流量的 QPS 达到阈值即触发系统保护。
    -   **是否开启**：打开表示启用该规则，关闭表示禁用该规则。
7.  单击**新增**。

## 管理系统规则 {#section_tl1_jn3_kgb .section}

在系统规则页面，您可以启用、禁用、编辑或删除系统规则。

-   单系统规则启用/禁用：

    在系统规则页面，找到目标应用下对应的系统规则，单击**状态**栏的启用开关，可快速启用或禁用该规则。

-   多个系统规则批量启用/禁用：

    在系统规则页面，勾选多个系统规则，单击**批量启用**或**批量禁用**，可快速启用或禁用多个规则。

-   编辑规则：

    在系统规则页面，找到目标应用下对应的系统规则，单击**操作**栏的**编辑**，可修改该规则的阈值。**阈值类型**不允许更改。

-   删除规则：

    在系统规则页面，找到目标资源下对应的系统规则，单击**操作**栏的**删除**。


