---
keyword: [切流, 多活容灾, 切流演练]
---

# 切流演练

切流演练可以对业务模拟切流操作，检验该业务的多活容灾能力。本文介绍如何创建、执行以及查看切流演练任务。

-   已完成命名空间配置，具体操作，请参见[新建命名空间](/cn.zh-CN/多活容灾/用户指南/异地双活配置/新建命名空间.md)。
-   已在数据层配置了多活属性并同步了链路的数据，具体操作，请参见[同步DRDS多活实例](/cn.zh-CN/多活容灾/用户指南/异地双活配置/异地数据层配置/同步DRDS多活实例.md)或[同步RDS多活实例](/cn.zh-CN/多活容灾/用户指南/异地双活配置/异地数据层配置/同步RDS多活实例.md)。

## 创建切流演练任务

1.  登录[AHAS控制台](https://ahas.console.aliyun.com)。

2.  在控制台左侧导航栏中选择**多活容灾**。

3.  在左侧导航栏选择**演练** \> **切流演练**，并在顶部选择命名空间。

4.  在切流演练页面，单击**创建演练**。

5.  在创建演练页面选择**演练类型**，然后单击**下一步**。

    目前支持以下三种演练类型：

    -   **前镜像演练**：验证切流规则下发后到切流规则正式生效前，前镜像匹配开启后防覆盖功能是否生效。
    -   **绝对禁写演练**：验证规则下发后到新规则生效前，为了避免脏数据产生而开启的数据禁写是否生效。
    -   **延迟策略演练**：验证数据对禁写生效后，是否有延迟禁写补充，保证全部数据集群均处于禁写状态。
6.  填写基本信息，然后单击**下一步**。

    |参数|描述|
    |--|--|
    |**演练名称**|填写演练名称。|
    |**演练备注**|为该演练添加描述，包括演练原因、演练场景以及演练可能造成的影响等信息。|
    |**自动恢复时间**|从演练启动后开始计时。开启演练后会对线上业务造成一定影响，请设置自动恢复时间，经过自动恢复时间后将自动停止本次演练，然后复原业务。|

7.  填写高级信息，然后单击**开始演练**。

    根据演练类型的不同，填写的高级信息不同。

    |参数|描述|
    |--|--|
    |**同步链路类型**|包括**RDS类型**和**DRDS类型**。|
    |**同步单元方向**|设置源单元和目标单元。|
    |**选择同步链路**|选中同步链路，可通过源实例库或目标实例库进行搜索。|
    |**禁写路由ID**|设置禁写路由ID，且仅限1个ID，单击**确认**。|
    |**禁写单元**|根据**禁写路由ID**自动生成禁写单元。|
    |**ACM中的IP地址**|选中ACM空间，并添加IP地址。需添加多个IP时可通过英文逗号（,）分隔，最多添加64个IP地址。|
    |**实例库**|选择实例库，可根据实例库名称进行搜索。|


## 执行切流演练

当切流演练任务创建完成后，进入演练详情页面，开始执行切流演练。

![执行切流.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7789000161/p210998.png)

您可以随时关注演练进度、演练时长、活动运行的结果等。切流演练执行界面分为以下几个区域。

|参数|描述|
|--|--|
|基本信息区域|包括了演练进度以及开始时间等信息。|
|保护策略区域|切流演练保护策略目前仅支持保护超时恢复。-   演练执行后，保护策略也同步开始执行。
-   若您手动终止演练，保护策略也会同时终止。 |
|演练执行情况区域|演练执行情况区域展示了当前演练的运行情况：-   当前演练节点执行成功，单击**确认**，执行下一个演练节点。
-   当前演练节点执行失败，单击**重试**或右上角的**终止演练**。 |
|演练配置信息区域|展示了该演练的单元同步方向、同步链路类型和具体实例等信息。|

在演练详情页面，您还可以进行以下操作：

-   当第一个演练节点执行成功，单击**确认**，执行下一个演练节点。

    ![执行切流1.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7789000161/p210996.png)

-   演练完成后，在结果反馈对话框中，填写演练反馈内容。

    ![执行切流3.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7789000161/p211005.png)


## 查看切流演练任务

1.  登录[AHAS控制台](https://ahas.console.aliyun.com)。

2.  在控制台左侧导航栏中选择**多活容灾**。

3.  在左侧导航栏选择**演练** \> **切流演练**，并在顶部选择命名空间。

    在切流演练页面，查看切流演练任务列表。

4.  在切流演练页面，单击目标演练任务**操作**列的**查看**。

    进入切流演练任务的详情页，查看切流演练的详细信息。


