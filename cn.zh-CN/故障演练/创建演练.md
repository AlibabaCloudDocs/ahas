# 创建演练 {#task_c4x_n1c_fhb .task}

利用 AHAS 的故障演练功能，您可以通过基于真实线上故障库的测试任务检验应用的高可用能力。演练对象仅支持阿里云 ECS 机器。

使用故障演练功能前，需要先安装探针。具体参见[阿里云 ECS 主机接入](../../../../../intl.zh-CN/架构感知/接入/阿里云 ECS 主机接入.md#)。

**一次完整的故障演练包括以下四个阶段：**

-   **准备阶段**：进行故障注入前的准备工作。例如，当故障注入影响 Java 进程时，则需要安装故障注入需要的 Agent；当故障注入仅影响 IO、CPU、Disk 等，则不需要安装 Agent。
-   **执行阶段**：执行故障注入。AHAS 提供了多种故障注入场景，您可以同时选择多个故障注入场景。
-   **检查阶段**：检查故障注入的效果是否符合预期。当故障注入成功之后，通过检验阶段的活动，可以自动检查故障注入是否生效。
-   **恢复阶段**：使故障注入的场景恢复正常。当故障演练自动结束、用户主动终止或者演练中的任何环节出现异常后，都会进入恢复阶段，清除相应的故障，使应用恢复正常。

**演练活动主要有以下场景类型**：

|涉及场景类型|演练活动|
|------|----|
|CPU|CPU满载|
|DISK|填充磁盘、磁盘IO高|
|Docker|删除Docker容器|
|Network|域名访问不通、网络延迟、网络丢包|
|Process|杀进程|

**说明：** 

-   通常，执行阶段和恢复阶段需要至少有一个演练活动，其他阶段根据需要配置。
-   在任何阶段选择一个演练活动后，AHAS 将自动识别其他阶段的依赖活动，并为您自动添加到对应阶段。

1.  登录 [AHAS 控制台](https://ahas.console.aliyun.com/)，在左侧导航栏中选择**故障演练** \> **演练列表**。 
2.  在故障演练页面右上角单击**新建演练**。 
3.  在新建演练页面，配置该演练场景的基本信息： 

    |配置项|配置说明|
    |---|----|
    |演练名称|填写演练名称|
    |演练描述|项：为该演练添加信息信息|
    |添加标签|自定义演练标签，便于演练的查询和统计。在**选择标签**框中，输入标签内容，按回车键完成输入。一个演练场景中，最多可输入五个标签。

标签将自动保存，下次您可以通过搜索或直接从下拉列表中选择已有的标签。

|

4.  在准备、执行、检查或恢复阶段下，单击 **+新建活动**，从列表中选择目标活动（示例：填充磁盘），单击**添加**。 选择一个活动后，系统将自动添加依赖活动，例如**恢复磁盘填充**。

    ![](https://aliware-images.oss-cn-hangzhou.aliyuncs.com/ahas/sc_chaos_create_dep.png) 

5.  单击已添加的演练活动，在右侧配置区域，配置相关信息。 
    -   参数：根据不同的演练活动，需要配置的参数不同。具体参数配置说明，参见[演练活动参数说明](intl.zh-CN/故障演练/演练活动参数说明.md#)。
    -   演练对象：在下拉列表中选择一个或多个主机，进行故障注入。

        已安装 AHAS 探针并处于在线状态的主机，将出现在演练对象的下拉列表中。

    -   是否手工推进演练
        -   **是**（手动方式）：当前演练活动执行完毕后，需要您手动触发去执行下一个演练活动。手动推进的方式适合需要持续观察故障注入现象的演练场景，例如与 CPU、磁盘相关的活动，通常需要人工确认故障注入生效之后，才会进行下一步。
        -   **否**（自动方式）：当前演练活动执行完毕后，自动执行下一个演练活动。
6.  单击**确定**，完成活动配置。 
7.  单击其他未配置活动，完成所有活动的配置。 

    **说明：** 

    -   鼠标悬停在演练活动卡片上，单击删除图标，可删除不需要的演练活动。
    -   系统会在浏览器中默认保存未完成的演练内容。当您再次进入新建演练页面时，可以选择继续编辑上次的演练草稿。
8.  单击新建演练页面右上角的**保存**。 

    返回演练列表中，您可以查看刚刚创建的演练。

    系统根据您选择的演练活动，自动添加**涉及场景**的标签，如 C （CPU）、D（DISK）、N（Network）等，方便您快速预览演练类型。


演练创建成功后，您可以：

-   执行演练

    在演练列表中的某个演练的**操作**列，单击**开始**，进行演练执行。具体参见[执行演练](intl.zh-CN/故障演练/执行演练.md#)。

-   查看并编辑演练详情

    在演练列表中的某个演练的**操作**列，单击**查看详情**，可查看演练内容。单击页面右上角**编辑**，可修改演练内容。

-   克隆演练

    在演练列表中的某个演练的**操作**列，单击**拷贝**，将克隆一个同名的演练，并编辑其具体内容。

-   删除演练

    在演练列表中的某个演练的**操作**列，单击**删除**。


