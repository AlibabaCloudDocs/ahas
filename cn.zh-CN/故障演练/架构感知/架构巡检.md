# 架构巡检

AHAS架构感知可以对接入AHAS的主机上的应用进行系统架构巡检，并展示所有诊断项和响应诊断结果，帮助您提前发现问题，保障系统稳定性。

将您的主机接入AHAS架构感知，具体操作，请参见[架构感知接入概述](/cn.zh-CN/故障演练/架构感知/接入应用/架构感知接入概述.md)。

## 架构巡检步骤

1.  登录[AHAS控制台](https://ahas.console.aliyun.com)，并在顶部菜单栏选择接入主机的地域。

2.  在左侧导航栏选择**故障演练** \> **架构感知**，然后选择**架构感知** \> **架构巡检**。

3.  在架构巡检页面单击**重新巡检**。

    **说明：** 当您的主机首次接入AHAS架构感知后，AHAS将自动对系统架构进行巡检，并列出所有诊断项和响应诊断结果。若巡检时间与接入时间间隔较大，请单击**重新巡检**。

    巡检完成后，架构巡检页面展示所有诊断项和响应诊断结果。

    在有风险巡检项的**操作**列，单击**查看威胁影响**，在右侧面板中将列出该诊断项的检查详情和影响。单击主机ID，可跳转至架构地图查看具体架构。

    ![架构巡检.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6633090261/p273492.png)


## 巡检设置

若您的系统中有不需要巡检的诊断项，可以通过以下步骤跳过巡检。

1.  登录[AHAS控制台](https://ahas.console.aliyun.com)，并在顶部菜单栏选择接入主机的地域。

2.  在左侧导航栏选择**故障演练** \> **架构感知**，然后选择**架构感知** \> **巡检设置**。

3.  在巡检设置页面的目标诊断项右侧**操作**列关闭开关。


## 定时巡检

您可以为应用系统创建定时巡检任务，创建步骤如下：

1.  登录[AHAS控制台](https://ahas.console.aliyun.com)，并在顶部菜单栏选择接入主机的地域。

2.  在左侧导航栏选择**故障演练** \> **架构感知**，然后选择**架构感知** \> **巡检设置**。

3.  在巡检设置页面，单击**定时巡检**页签。

4.  在定时巡检页面，单击**创建定时巡检任务**。

5.  在定时巡检任务设置页面进行以下设置：

    1.  选择**集群**。

    2.  选择**定时模式**。

        -   **一般**：一般模式包括月粒度和周粒度的定时模式。频率选择每月或每周，然后选中日期或星期。设置定时巡检的时间。
        -   **高级**：编写crontab高级表达式自定义执行时间。
            -   只能选择按照日或者周，指定执行压测时间。日和周只能二选一，指定日或周之后，另外一个输入框内需填写`?`，表示不受限制。例如，上图所示，指定了每个月1、2号，**周**需填写`?`。
            -   在crontab表达式内，请使用英文字符，如英文通配符（\*、?）。
            -   多个值之间用英文逗号（,）分隔。
            -   值的区间用短划线（-）连接，例如**日**输入框内填写`1-5`，表示1号至5号。
            -   填写周时，1表示周日，7表示周六；即每周从周日到周六的数字为`1-7`。
            -   正斜线（/）可以用来指定间隔频率，例如间隔2天，用`*/2`表示。
            -   crontab表达式由5列数字组合而成，取值说明如下：

                -   **分**（分钟）：`0-59`。
                -   **时**（小时）：`0-23`，0表示子夜。
                -   **日**（每个月的具体日期）：`1-31`。
                -   **月**：不可修改，目前仅支持每个月。
                -   **周**（星期）：`1-7`，1表示星期日，2表示星期一，以此类推。
                **crontab表达式示例**：

                -   每星期六、星期日的23:00执行。

                    ![crontab1.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6633090261/p273529.png)

                -   每月5、15、25日的09:30执行。

                    ![crontab2.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6633090261/p273531.png)

                -   每隔两天的零点执行。

                    ![crontab3.png](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6633090261/p273533.png)

    3.  选择**开始时间**，精确到秒。

    4.  选择**结束重复**的日期和时间。可在执行预览中查看设置的最近5次执行时间。

    5.  单击**立即执行**。


