# 降级规则 {#concept_wnz_bm3_kgb .concept}

AHAS 的降级功能可以监控应用下游依赖的响应时间或异常比例，当达到指定的阈值时立即降低下游依赖的优先级，避免应用受到影响，从而保障应用高可用性。

## 背景信息 {#section_mr1_x5d_ggb .section}

除了流量控制以外，对调用链路中不稳定的资源进行熔断降级也是重要措施之一。由于调用关系的复杂性，如果调用链路中的某个资源出现了不稳定，最终会导致请求发生堆积。熔断降级功能会在调用链路中某个资源出现不稳定时（例如某资源出现 Timeout 或异常比例升高），对这个资源的调用进行限制，让请求快速失败，避免影响到其它的资源而导致级联错误。

降级规则配置通常用于[弱依赖降级](intl.zh-CN/应用流控降级/流控降级原则/弱依赖降级.md#)场景。

## 新建降级规则 {#section_bb2_ptd_ggb .section}

1.  登录 [AHAS 控制台](https://ahas.console.aliyun.com/)。
2.  在 AHAS 控制台左上角，选择应用接入的**地域**。
3.  在控制台左侧导航栏中选择**流控降级** \> **应用流控降级**。
4.  在应用列表页面单击目标应用卡片。
5.  选择以下任意一种方法进入新建流控规则页面：
    -   在左侧导航栏单击**监控详情**，在监控详情页面单击资源卡片右上角 ，然后在新增规则对话框中选择流控规则降级规则页签。
    -   在左侧导航栏单击簇点链路，然后单击目标资源**操作**列中的**降级**。
    -   在左侧导航栏单击降级规则，然后在页面右上角单击**新增降级规则**。
6.  在新建降级规则对话框中配置规则信息。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/92303/156698879158024_zh-CN.png)

    -   **资源名称**：适用该规则的应用资源。
    -   **阈值类型**：选择以 **RT** （ 响应时间）或**异常比例**作为阈值。
        -   选择以**RT**（ 响应时间）作为阈值，并填写以毫秒为单位的时间。

            规则开启后，按照**秒级的平均响应时间**进行降级。如果持续进入 5 个请求，对应的平均 RT 都持续超过降级阈值，则会被自动降级。

        -   选择以**异常比例**作为阈值，并在**比例**字段中填写 0 到 1 之间的小数作为比例。

            规则开启后，按照**秒级的异常比例**进行降级。当资源的每秒异常总数占通过量的比值超过阈值之后，资源进入降级状态。

    -   **时间窗口**：即降级触发后持续的时间。资源进入降级状态后，在配置的降级窗口时间内，请求都会快速失败。
    -   **是否开启**：打开表示启用该规则，关闭表示禁用该规则。
7.  单击**新建**。

## 管理降级规则 {#section_zdy_vm3_kgb .section}

在降级规则页面，您可以启用、禁用、编辑或删除降级规则。

-   单降级规则启用/禁用：

    在降级规则页面，找到目标资源下对应的降级规则，单击**状态**栏的启用开关，可快速启用或禁用该规则。

-   多个降级规则批量启用/禁用：

    在降级规则页面，勾选多个降级规则，单击**批量启用**或**批量禁用**，可快速启用或禁用多个规则。

-   编辑规则：

    在降级规则页面，找到目标资源下对应的降级规则，单击**操作**栏的**编辑**，可修改该规则的相关信息。

-   删除规则：

    在降级规则页面，找到目标资源下对应的降级规则，单击**操作**栏的**删除**。


